\section{Use case overview}\label{sec:uc_overview}

\paragraph{UCXXX: send data to gateway}
A mote sends data to a gateway.
\paragraph{UCXXX: upload application}
An appplication provider uploads an application to the Online Service.
\paragraph{UCXXX: get data from sensor}
An application requests to get data from a specific sensor.
\paragraph{UCXXX: search for applications}
A customer organisation representative searches for available applications they
could potentially subscribe to.
\paragraph{UCXXX: review application}
A SIoTIP system administrator reviews and approves or declines it.
\paragraph{UC01: }
\paragraph{UC02: }
\paragraph{UC03: }
\paragraph{UC04: }
\paragraph{UC05: }
\paragraph{UC06: }
\paragraph{UC07: }
\paragraph{UC08: }
\paragraph{UC09: }
\paragraph{UC10: }
\paragraph{UC11: }
\paragraph{UC12: }
\paragraph{UC13: }
\paragraph{UC14: }
\paragraph{UC15: }
\paragraph{UC16: }
\paragraph{UC17: }
\paragraph{UC18: }
\paragraph{UC19: }
\paragraph{UC20: }
\paragraph{UC21: }
\paragraph{UC22: }
\paragraph{UC23: }
\paragraph{UC24: }
\paragraph{UC25: }
\paragraph{UC26: }
\paragraph{UC27: }
\paragraph{UC28: }
\paragraph{UC29: }
\paragraph{UC30: }
\paragraph{UC31: }

\section{Detailed use cases}

\subsection{\emph{UC17}: Send sensor data}
\begin{itemize}
    \item \textbf{Name:} Send sensor data
    \item \textbf{Primary actor:} Mote
    \item \textbf{Secondary actors:} Sensor, Gateway
    \item \textbf{Interested parties:}
        \begin{itemize}
            \item \textit{Customer organisation:} pays for an application that uses this sensor.
            \item \textit{End-users:} use the sensor data in an application.
            \item \textit{Gateway:} stores this data.
            \item \textit{Online Service:} stores this data.
        \end{itemize}

    \item \textbf{Preconditions:}
        \begin{itemize}
            \item The mote has received data from a sensor connected to it.
            \item The mote is connected to a gateway.
        \end{itemize}

    \item \textbf{Postconditions:}
        \begin{itemize}
            \item The gateway has received and processed the sensor data.
            \item The Online Service has received the data and can process it.
        \end{itemize}

    \item \textbf{Main scenario:}
        \begin{enumerate}
           \item The mote sends the sensor data to the connected gateway.
           \item The gateway receives the data and if applicable, runs some application logic.
           \item The gateway collects data until a synchronisation point is reached.
                 At that point, the gateway sends the data to the Online Service.
        \end{enumerate}

    \item \textbf{Alternative scenarios:}
        \begin{enumerate}
            \item [3b.] The gateway determined that the data was important
                  (e.g. cause for alarm, notification, etc.) and sent the data
                  to the Online Service immediately instead of waiting for the
                  sycnhronisation point.
        \end{enumerate}

    \item \textbf{Remarks:}
        \begin{itemize}
            \item It is essential that the synchronisation protocol works
                  correctly in the presence of non-reliable network communication
                  so that there is no loss of data.
        \end{itemize}
\end{itemize}

\subsection{\emph{UC6}: Upload application}
\begin{itemize}
    \item \textbf{Name:} Upload application
    \item \textbf{Primary actor:} application provider
    \item \textbf{Interested parties:}
        \begin{itemize}
            \item \textit{Customers organisations:} want to subscribe to the applications.
        \end{itemize}

    \item \textbf{Preconditions:}
        \begin{itemize}
            \item The application provider is authenticated.
            \item The application provider has an application to upload.
        \end{itemize}

    \item \textbf{Postconditions:}
        \begin{itemize}
            \item The application is uploaded into the system.
            \item The application passed the system's automated tests.
            \item The application is made available to customer organisations for subscription.
        \end{itemize}

    \item \textbf{Main scenario:}
    \begin{enumerate}
       \item The application provider navigates to his dashboard.
       \item The application provider indicates he wants to upload an application.
       \item The application provider selects the application to be uploaded and
             uploads it.
       \item The system receives the application and stores it.
       \item The application undergoes a number of automated tests.
       \item The application provider follows the progress and results
             of these tests via the application provider dashboard.
       \item The application passes all tests.
       \item The system makes the application available for the customers organisations.
       \item The system sends a notification to the application provider.
    \end{enumerate}

    \item \textbf{Alternative scenarios:}
    \begin{enumerate}
        \item [4b.] The system did not receive the application and sends an error
                    to the application provider. Return to step 2.
        \item [7c.] The application did not pass all tests.
        \item [8c.] The application will will need to be approved by a SIoTIP
                    system administrator before it can be made available to
                    customer organisations. (cf. review application (UCX))
    \end{enumerate}
\end{itemize}

\subsection{\emph{UC4}: Get data from sensors/actuators}
\begin{itemize}
    \item \textbf{Name:} Get data from sensors/actuators
    \item \textbf{Primary actor:} Application
    \item \textbf{Secondary actor(s)}: Online Service, Gateway, Mote
    \item \textbf{Interested parties:}
        \begin{itemize}
            \item \textit{End-user:} wants to get information from sensors.
        \end{itemize}

    \item \textbf{Preconditions:}
        \begin{itemize}
            \item The application is enabled.
            \item The hardware that the application tries to get data from
                  is connected to the system and can be used.
            \item The application has access rights to the hardware it tries to
                  get data from.
        \end{itemize}

    \item \textbf{Postconditions:}
        \begin{itemize}
            \item The application received the data it requested.
        \end{itemize}

    \item \textbf{Main scenario:}
    \begin{enumerate}
       \item The application sends a request to the Online Service, specifying
             which hardware it wants data from.
       \item The Online Service communicates this data to the relevant gateways.
       \item The gateways send requests for data to motes.
       \item The motes send data to the Online Service (cf. send sensor data (UCXX))
       \item The Online Service collects all the data and sends it to the application.
    \end{enumerate}

    \item \textbf{Alternative scenarios:}
    \begin{enumerate}
        \item [5b.] The application recognizes it did not receive any reply within 1s.
                    Return to step 1.
    \end{enumerate}
\end{itemize}

\subsection{\emph{UC31}: Subscribe to application}
\begin{itemize}
    \item \textbf{Name:} Subscribe to application
    \item \textbf{Primary actor:} Customer orgranisation representative
    \item \textbf{Interested parties:}
        \begin{itemize}
            \item \textit{Infrastructure owner:} provides hardware that the application can use.
        \end{itemize}

    \item \textbf{Preconditions:}
        \begin{itemize}
            \item The customer organisation is authenticated.
            \item The application is available to be subscribed to.
        \end{itemize}

    \item \textbf{Postconditions:}
        \begin{itemize}
            \item The customer organisation is subscribed to the application.
            \item The customer organisation can use/configure the application.
        \end{itemize}

    \item \textbf{Main scenario:}
    \begin{enumerate}
       \item The representative indicates that he wants to subsribe to an
             application.
       \item The representative is notified that the application will be activated
             once the required hardware is installed.
       \item The infrastructure owner is notified of the subscription.
       \item The infrastructure owner updates the access rights to the hardware
             that is neccessary for the application.
       \item The application is activated.
       \item The customer organisation representative is notified.
    \end{enumerate}

    \item \textbf{Alternative scenarios:}
    \begin{enumerate}
        \item [2b.] Extra hardware is required for the application to work.
        \item [3b.] The infrastructure owner is notified of the subscription and
                    approves the purchase.
        \item [4b.] The infrastructure owner installs the new hardware and updates
                    the topology and access rights.
    \end{enumerate}
\end{itemize}

\subsection{\emph{UC02}: Review application}
\begin{itemize}
    \item \textbf{Name:} Review application
    \item \textbf{Primary actor:} SIoTIP System Administrator
    \item \textbf{Secondary actor(s)}:
    \item \textbf{Interested parties:}
        \begin{itemize}
            \item \textit{application providers:} want to add their application to the system
        \end{itemize}

    \item \textbf{Preconditions:}
        \begin{itemize}
            \item The system administrator is authenticated.
            \item The application needs to be reviewed by a system administrator.
        \end{itemize}

    \item \textbf{Postconditions:}
        \begin{itemize}
            \item The system adminstrator accepts or declines the application.
            \item The application providers have been notified of this event.
        \end{itemize}

    \item \textbf{Main scenario:}
        \begin{enumerate}
            \item The system administrator navigates to the applications component on their
                  dashboard and selects the application that needs to be reviewed.
            \item The system administrator reviews the application's functionality and
                  log history, and the message history with the application provider.
            \item The system administrator indicates he wants to accept the application.
            \item The system logs this event and makes the application available to
                  customer ogranisations.
            \item The system notifies the application providers.
        \end{enumerate}

    \item \textbf{Alternative scenarios:}
        \begin{enumerate}
            \item [3b.] The system administrator indicates he wants decline to the application
                  and is prompted by the system to fill in the reason for this. The
                  application will thus not become available to customer organisations.
            \item [3c.] The system administrator indicates he wants communicate
                  with the provider before making a decision. Afterwards, return to
                  step 2.
        \end{enumerate}

    \item \textbf{Remarks:}
        \begin{itemize}
            \item When an application first gets uploaded to the system, it needs to be
                  reviewed and accepted by a system administrator. This will prevent
                  the available apps to be flooded with apps of very poor quality
                  or apps that are copies of other apps.
            \item If at some point in the future, automated testing for an app fails,
                  the app will need to be reviewed again before it can be made
                  available again.
        \end{itemize}
\end{itemize}
