\section{Decomposition 8: UC22, UC23 (Elements/Subsystem to decompose/expand)}


\subsection{Selected architectural drivers}
    The functional drivers are:
    \begin{itemize}
        \item \emph{UC22}: Upload an application
        \item \emph{UC23}: Consult application statistics
    \end{itemize}

    UC22:
        1. The primary actor indicates that he/she wants to upload an application.
            IN CLIENT

        2. The system asks the primary actor if he/she wants to update an existing application.
            IN CLIENT

        3. The primary actor provides his/her choice.

            TODO

        4. If the primary actor indicated that he/she wants to update an existing application,
           the system composes an overview of applications uploaded by the primary actor
           (e.g., as a list or table), presents this, and requests the primary actor to indicate which application to update.

            ApplicationProviderFacade -> ApplicationManager: interface FrontEndAppRequests:
                                                List<Application> getApplicationsForAppProvider(int appProviderID)
                Effect: Returns list of applications uploaded by the application provider.
                \item Created for: UC22.4

            ApplicationManager -> OtherDataDB: interface DBAppMgmt:
                                                List<Application> getApplicationsForAppProvider(int appProviderID)
                Effect: Returns list of applications uploaded by the application provider.
                \item Created for: UC22.4


        5. The primary actor chooses the application to be updated.

            ApplicationProviderClient -> ApplicationProviderFacade: interface Apps:
                                                void updateApplication(int applicationID)


        6. The system asks the primary actor if this is an update that should be automatically activated for existing subscriptions.

            TODO

        7. The primary actor provides his/her choice.

            TODO

        8. If the primary actor has indicated that existing subscriptions should be automatically updated, the system requests the versions (or range of versions) that should be automatically updated.

            TODO

        9. The primary actor provides the requested information.

            TODO

        10. The system asks the primary actor to upload the application code, a description for display to customer organisations, and meta-data (such as the version number and subscription price).

            TODO

        11. The primary actor uploads the requested information.

            TODO

        12. The system performs automated application checks.

            TODO

        13. If the checks were successful, the system sends a notification to the primary actor (Include: UC15 : Send notification).

            TODO

        14. The system makes the application available in the application store. In case of an updated application, it replaces the previous versions of the application.

            TODO

        15. In case of an updated application that should automatically be activated for existing subscriptions (cf. step 6), the system updates the existing subscriptions of the application to the new version (Include: UC17 : Activate an application).

            TODO

        Alternative
            4a. If the primary actor has indicated that he/she wants to upload a new application, the use case
                continues from step 10.
            8a. If the primary actor has indicated that existing subscriptions should not be automatically
                updated, the use case continues from step 10.
            13a.If the checks were not successful, the system notifies the primary actor and a SysAdmin
                (Include: UC15: Send notification). The use case ends.

        Remarks:
            { For updated applications, application providers have the choice between automatically updating
              all application subscriptions of the previous version, or requiring customer organisations
              to subscribe to the new version individually (cf. UC19: Subscribe to application). The latter
              could be used if the application provider requires the customer organisations to pay for the
              new version. They may, however, also use the former model for some updates, such as minor
              improvements and bugfixes. Requiring the customer organisations to explicitly subscribe to
              the new version can also be useful in case the new version requires new hardware.
            { Explicitly indicating the versions from which to automatically update (in step 8) is necessary
              to prevent the automatic (and free) update from v2.0 to v2.1 to also be installed for v1.x
              subscriptions, thereby bypassing the paid upgrade from v1.x to v2.0.
            { For simplicity, the workflow of a sysadmin that manually reviews and approves/rejects an
              application that has failed automatic testing (as mentioned in Part 1 of the assignment) is not
              part of this assignment.


    UC23:
        1. The primary actor indicates that he/she wants to an overview of uploaded applications.

            ApplicationProviderClient -> ApplicationProviderFacade: interface Apps:
                                                    void getApplicationDetailsForAppProvider(int appProviderID)
                Effect: Returns list of applications uploaded by the application provider and information about the amount of subscribers
                        for that application.
                \item Created for: UC23.2

        2. The system retrieves all applications uploaded by the primary actor, and information about the amount of subscribers for that
           application. It presents this overview to the primary actor.

            ApplicationProviderFacade -> ApplicationManager: interface FrontEndAppRequests:
                                                List<Application,int> getApplicationDetailsForAppProvider(int appProviderID)
                Effect: Returns list of applications uploaded by the application provider and information about the amount of subscribers
                        for that application.
                \item Created for: UC23.2

            ApplicationManager -> OtherDataDB: interface DBAppMgmt:
                                                List<Map<Application,int> getApplicationDetailsForAppProvider(int appProviderID)
                Effect: Returns list of applications uploaded by the application provider and information about the amount of subscribers
                        for that application.
                \item Created for: UC23.2

        3. The primary actor selects an application.

            ApplicationProviderClient -> ApplicationProviderFacade: interface Apps:
                                                    ApplicationStatistics presentApplicationStatistics(int applicationID)
                Effect: Returns statistics about application if the selected application is approved.
                \item Created for: UC23.3

        4. If the selected application is an approved application, the system presents detailed statistics including the amount of
        subscribers.

        ApplicationProviderFacade -> ApplicationManager: interface FrontEndAppRequests:
                                                    ApplicationStatistics presentApplicationStatistics(int applicationID)
                Effect: Returns statistics about application if the selected application is approved.
                \item Created for: UC23.4

        ApplicationManager -> OtherDataDB: interface DBAppMgmt:
                                                    ApplicationStatistics presentApplicationStatistics(int applicationID)
                Effect: Returns statistics about application if the selected application is approved.
                \item Created for: UC23.4




\subsection{Instantiation and allocation of functionality}
    This section lists the new components which instantiate our solutions
    described in the section above. For each component we note the quality
    attribute or use case that prompted us to create it. Descriptions about
    the components can be found under chapter \ref{ch:elements-datatypes}. \\

    \begin{itemize}
        \item Component: (Relevant UC)
    \end{itemize}


\subsection{Interfaces for child modules}
    This section lists new interfaces assigned to the components defined
    in the section above. Detailed information about each interface and
    its methods can be found under chapter \ref{ch:elements-datatypes}.

    \subsubsection{Component}
        \begin{itemize}
            \item Interface
        \end{itemize}

\subsection{New data types}
    This section lists the new data types introduced during this decomposition.

    \begin{itemize}
        \item DateTime: Represents an instant in time, typically expressed as a date and time of day.
    \end{itemize}
