\section{Decomposition 9: UC21 (Elements/Subsystem to decompose/expand)}


\subsection{Selected architectural drivers}
    The functional drivers are:
    \begin{itemize}
        \item \emph{UC21}: Send invoice
    \end{itemize}

    UC21: Send invoice
        1. The system constructs an invoice containing:
            { the provided service or product (e.g. monthly subscription fee for applications or purchased hardware),
            { the amount to be paid,
            { the date the payment is due and
            { the contact details of the primary actor (e.g. Zoomit identifier or credit card data)

                SubscriptionManager -> InvoiceManager: interface InvoiceMgmt: void constructInvoiceForApplicationInstance(int applicationInstanceID, int customerOrganisationID)
                    Effect: Constructs an invoice for outstanding payments for an ApplicationIntance
                    \item Created for: UC20.4iii

        2. The system sends the invoice to the third-party invoicing service.

            InvoiceManager -> OtherDataDB: interface InvoiceMgmt: void createInvoice(Invoice invoice)
                    Effect: Stores a new invoice in the database.
                    \item Created for: UC20.4iii

            InvoiceManager -> ThirdPartyInvoicingService: interface InvoiceMgmt: void sendInvoice(Map<string, string> invoiceData)
                    Effect: Sends an invoice using a third party invoicing service.
                    \item Created for: UC20.4iii


\subsection{Instantiation and allocation of functionality}
    This section lists the new components which instantiate our solutions
    described in the section above. For each component we note the quality
    attribute or use case that prompted us to create it. Descriptions about
    the components can be found under chapter \ref{ch:elements-datatypes}. \\

    \begin{itemize}
        \item ThirdPartyInvoicingService: UC21
    \end{itemize}


\subsection{Interfaces for child modules}
    This section lists new interfaces assigned to the components defined
    in the section above. Detailed information about each interface and
    its methods can be found under chapter \ref{ch:elements-datatypes}.

    \subsubsection{ThirdPartyInvoicingService}
        \begin{itemize}
            \item InvoiceDeliveryMgmt
        \end{itemize}

    \subsubsection{InvoiceManager}
        \begin{itemize}
            \item DeliveryMgmt
        \end{itemize}
